# üöÄ OhMyRevit - Revit Content Marketplace

Telegram Mini App –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å –ø—Ä–µ–º—ñ—É–º –∫–æ–Ω—Ç–µ–Ω—Ç—É –¥–ª—è Autodesk Revit –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é –ø—ñ–¥–ø–∏—Å–æ–∫, –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó –≤–∞–ª—é—Ç–∏ (OMR Coins), –±–æ–Ω—É—Å–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏—Ö –ø–µ—Ä–µ–∫–ª–∞–¥—ñ–≤.

![Version](https://img.shields.io/badge/version-1.7.3-blue)
![Next.js](https://img.shields.io/badge/Next.js-14-black)
![FastAPI](https://img.shields.io/badge/FastAPI-0.104+-green)
![Python](https://img.shields.io/badge/Python-3.11+-blue)

## üìã –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ

- ‚úÖ **Telegram Mini App** - –ù–∞—Ç–∏–≤–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Telegram WebApp
- üí∞ **OMR Coins** - –í–Ω—É—Ç—Ä—ñ—à–Ω—è –≤–∞–ª—é—Ç–∞ (100 coins = $1 USD)
- üéÅ **–ë–æ–Ω—É—Å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞** - –©–æ–¥–µ–Ω–Ω—ñ –±–æ–Ω—É—Å–∏ —Ç–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞
- üîê **Dual Auth** - Telegram —Ç–∞ Email/Password –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è
- üìß **Email —Å–∏—Å—Ç–µ–º–∞** - Resend + Gmail fallback
- üí≥ **Gumroad –ø–ª–∞—Ç–µ–∂—ñ** - –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è —á–µ—Ä–µ–∑ webhook
- üåç **–ú—É–ª—å—Ç–∏–º–æ–≤–Ω—ñ—Å—Ç—å** - DeepL –∞–≤—Ç–æ–ø–µ—Ä–µ–∫–ª–∞–¥–∏ (UK, EN, RU, DE, ES)
- üé® **–ê–¥–∞–ø—Ç–∏–≤–Ω–∏–π –¥–∏–∑–∞–π–Ω** - Light/Dark —Ç–µ–º–∏ –∑ —Å–∏—Å—Ç–µ–º–Ω–æ—é —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—î—é
- üì± **PWA Ready** - –ü—Ä–∞—Ü—é—î —è–∫ –∑–≤–∏—á–∞–π–Ω–∏–π –≤–µ–±-—Å–∞–π—Ç —ñ Telegram Mini App

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏–π —Å—Ç–µ–∫

### Backend
- **FastAPI** - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π Python –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **SQLAlchemy 2.0** - ORM –∑ async –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é
- **PostgreSQL** - –û—Å–Ω–æ–≤–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö
- **Redis** - –ö–µ—à—É–≤–∞–Ω–Ω—è —Ç–∞ rate limiting
- **Alembic** - –ú—ñ–≥—Ä–∞—Ü—ñ—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
- **Pydantic** - –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö
- **APScheduler** - –§–æ–Ω–æ–≤—ñ –∑–∞–¥–∞—á—ñ (cleanup, webhooks)

### Frontend
- **Next.js 14** - React —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –∑ App Router
- **TypeScript** - –¢–∏–ø—ñ–∑–∞—Ü—ñ—è
- **TailwindCSS** - –°—Ç–∏–ª—ñ–∑–∞—Ü—ñ—è
- **Zustand** - State management
- **Framer Motion** - –ê–Ω—ñ–º–∞—Ü—ñ—ó
- **React Hot Toast** - –ù–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- **React i18next** - –Ü–Ω—Ç–µ—Ä–Ω–∞—Ü—ñ–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è

### –Ü–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **Docker Compose** - –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü—ñ—è —Å–µ—Ä–≤—ñ—Å—ñ–≤
- **Nginx** - Reverse proxy (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
- **Cloudflare Tunnel** - –ë–µ–∑–ø–µ—á–Ω–∏–π –¥–æ—Å—Ç—É–ø (production)

### –ó–æ–≤–Ω—ñ—à–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏
- **Telegram Bot API** - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —Ç–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- **Gumroad** - –ü–ª–∞—Ç—ñ–∂–Ω–∞ —Å–∏—Å—Ç–µ–º–∞
- **Resend** - Email –¥–æ—Å—Ç–∞–≤–∫–∞
- **DeepL** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –ø–µ—Ä–µ–∫–ª–∞–¥–∏
- **Sentry** - Error tracking (production)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
ohmyrevit/
‚îú‚îÄ‚îÄ backend/                    # FastAPI Backend
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core/              # –Ü–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (DB, auth, email, cache, scheduler)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users/             # –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ products/          # –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä—ñ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ orders/            # –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –ø—Ä–æ–º–æ–∫–æ–¥–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ subscriptions/     # Premium –ø—ñ–¥–ø–∏—Å–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ wallet/            # OMR Coins + Gumroad —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bonuses/           # –©–æ–¥–µ–Ω–Ω—ñ –±–æ–Ω—É—Å–∏ —Ç–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ collections/       # –ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –∫–æ–ª–µ–∫—Ü—ñ—ó (favorites)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ referrals/         # –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile/           # –ü—Ä–æ—Ñ—ñ–ª—å —Ç–∞ download –¥–æ—Å—Ç—É–ø–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/             # –ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ bot/               # Telegram webhook handler
‚îÇ   ‚îú‚îÄ‚îÄ alembic/               # Database migrations
‚îÇ   ‚îú‚îÄ‚îÄ tests/                 # Pytest tests
‚îÇ   ‚îî‚îÄ‚îÄ uploads/               # File storage (images, archives)
‚îú‚îÄ‚îÄ frontend/                   # Next.js Frontend
‚îÇ   ‚îú‚îÄ‚îÄ app/                   # Next.js App Router pages
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ marketplace/       # –ì–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∑ —Ç–æ–≤–∞—Ä–∞–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ product/[id]/      # –î–µ—Ç–∞–ª—ñ —Ç–æ–≤–∞—Ä—É
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cart/              # –ö–æ—à–∏–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ subscription/      # Premium –ø—ñ–¥–ø–∏—Å–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile/           # –ü—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ wallet/        # –ì–∞–º–∞–Ω–µ—Ü—å OMR Coins
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bonuses/       # –©–æ–¥–µ–Ω–Ω—ñ –±–æ–Ω—É—Å–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ referrals/     # –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ downloads/     # –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settings/      # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ faq/           # FAQ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ admin/             # –ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ components/            # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ store/                 # Zustand stores
‚îÇ   ‚îú‚îÄ‚îÄ lib/                   # Utils —Ç–∞ API client
‚îÇ   ‚îú‚îÄ‚îÄ types/                 # TypeScript types
‚îÇ   ‚îî‚îÄ‚îÄ public/                # –°—Ç–∞—Ç–∏—á–Ω—ñ —Ñ–∞–π–ª–∏, –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ nginx/                     # Nginx –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
‚îú‚îÄ‚îÄ docker-compose.yml         # Docker Compose setup
‚îú‚îÄ‚îÄ Makefile                   # –ö–æ–º–∞–Ω–¥–∏ –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏
‚îú‚îÄ‚îÄ CLAUDE.md                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –¥–ª—è Claude Code
‚îî‚îÄ‚îÄ README.md                  # –¶–µ–π —Ñ–∞–π–ª
```

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### –í–∏–º–æ–≥–∏

- Docker —Ç–∞ Docker Compose
- Make (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ, –∞–ª–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)
- Telegram Bot Token (–≤—ñ–¥ [@BotFather](https://t.me/BotFather))
- DeepL API Key (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –∞–≤—Ç–æ–ø–µ—Ä–µ–∫–ª–∞–¥—ñ–≤)
- Resend API Key (–¥–ª—è email —Ä–æ–∑—Å–∏–ª–æ–∫)

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

```bash
# –ö–ª–æ–Ω—É—î–º–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
git clone https://github.com/yourusername/ohmyrevit.git
cd ohmyrevit

# –ö–æ–ø—ñ—é—î–º–æ .env.example –≤ .env
make init
# –ê–ë–û –≤—Ä—É—á–Ω—É:
cp .env.example .env

# –†–µ–¥–∞–≥—É—î–º–æ .env —Ç–∞ –∑–∞–ø–æ–≤–Ω—é—î–º–æ –∫–ª—é—á—ñ
nano .env
```

### 2. –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è .env

```bash
# === –ö–†–ò–¢–ò–ß–ù–û –í–ê–ñ–õ–ò–í–Ü ===
TELEGRAM_BOT_TOKEN=your_bot_token_here          # –í—ñ–¥ @BotFather
SECRET_KEY=your_secret_key_32_chars_min         # openssl rand -hex 32
DATABASE_URL=postgresql+asyncpg://postgres:postgres@db:5432/ohmyrevit
RESEND_API_KEY=re_your_resend_key               # Email —Å–µ—Ä–≤—ñ—Å

# === URLs ===
FRONTEND_URL=http://localhost:3000              # –î–ª—è development
BACKEND_URL=http://localhost:8000               # –î–ª—è development
ALLOWED_ORIGINS=http://localhost:3000,https://t.me

# === –û–ü–¶–Ü–û–ù–ê–õ–¨–ù–û ===
DEEPL_API_KEY=your_deepl_key                    # –î–ª—è –∞–≤—Ç–æ–ø–µ—Ä–µ–∫–ª–∞–¥—ñ–≤
GUMROAD_WEBHOOK_SECRET=your_gumroad_secret      # –î–ª—è Gumroad webhooks
SUPPORT_EMAIL=support@yourdomain.com            # Email –ø—ñ–¥—Ç—Ä–∏–º–∫–∏
```

### 3. –ó–∞–ø—É—Å–∫

```bash
# –ó–±–∏—Ä–∞—î–º–æ —Ç–∞ –∑–∞–ø—É—Å–∫–∞—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏
make build
make up

# –ó–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ –º—ñ–≥—Ä–∞—Ü—ñ—ó –ë–î
make migrate

# –î–∏–≤–∏–º–æ—Å—å –ª–æ–≥–∏
make logs
```

### 4. –î–æ—Å—Ç—É–ø –¥–æ —Å–µ—Ä–≤—ñ—Å—ñ–≤

- üåê **Frontend:** http://localhost:3000
- üîß **Backend API:** http://localhost:8000
- üìö **API Docs (Swagger):** http://localhost:8000/api/docs
- üóÑÔ∏è **Adminer (DB GUI):** http://localhost:8080
  - –°–∏—Å—Ç–µ–º–∞: PostgreSQL
  - –°–µ—Ä–≤–µ—Ä: db
  - –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á: postgres
  - –ü–∞—Ä–æ–ª—å: postgres
  - –ë–∞–∑–∞: ohmyrevit

## üîß –ö–æ–º–∞–Ω–¥–∏ —Ä–æ–∑—Ä–æ–±–∫–∏

### Docker –æ–ø–µ—Ä–∞—Ü—ñ—ó

```bash
make dev                # –ó–∞–ø—É—Å–∫ —É foreground –∑ –ª–æ–≥–∞–º–∏
make up                 # –ó–∞–ø—É—Å–∫ —É background
make down               # –ó—É–ø–∏–Ω–∏—Ç–∏ –≤—Å—ñ —Å–µ—Ä–≤—ñ—Å–∏
make restart            # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤—ñ—Å–∏
make logs               # –ü–æ–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ –ª–æ–≥–∏
make logs-backend       # –¢—ñ–ª—å–∫–∏ backend –ª–æ–≥–∏
make logs-frontend      # –¢—ñ–ª—å–∫–∏ frontend –ª–æ–≥–∏
make shell-backend      # Bash –≤ backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ
```

### –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö

```bash
make migrate                              # –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó
make makemigration msg="–æ–ø–∏—Å –∑–º—ñ–Ω"        # –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É –º—ñ–≥—Ä–∞—Ü—ñ—é
make downgrade                            # Rollback –æ–¥–Ω—É –º—ñ–≥—Ä–∞—Ü—ñ—é
make migration-history                    # –Ü—Å—Ç–æ—Ä—ñ—è –º—ñ–≥—Ä–∞—Ü—ñ–π
make shell-db                             # PostgreSQL shell
make db-backup                            # Backup –ë–î
make db-restore file=backup.sql           # –í—ñ–¥–Ω–æ–≤–∏—Ç–∏ –∑ backup
```

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

```bash
# –í—Å—ñ —Ç–µ—Å—Ç–∏
docker-compose exec backend pytest -v

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Ñ–∞–π–ª
docker-compose exec backend pytest tests/test_wallet.py -v

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Ç–µ—Å—Ç
docker-compose exec backend pytest tests/test_wallet.py::test_purchase -v

# –ó –ø–æ–∫—Ä–∏—Ç—Ç—è–º
make test-coverage

# –ü—Ä–æ—Å—Ç–∏–π —Ç–µ—Å—Ç (–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ setup)
make test-simple
```

### Code quality

```bash
make format             # Black code formatting
make lint               # Flake8 linting
make type-check         # TypeScript type checking (frontend)
```

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

### Backend - –ú–æ–¥—É–ª—å–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

–ö–æ–∂–µ–Ω —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π –±–ª–æ–∫ - —Ü–µ –æ–∫—Ä–µ–º–∏–π –ø–∞–∫–µ—Ç –ø—ñ–¥ `backend/app/` –∑ –≤–ª–∞—Å–Ω–∏–º–∏:
- `models.py` - SQLAlchemy –º–æ–¥–µ–ª—ñ
- `schemas.py` - Pydantic —Å—Ö–µ–º–∏ (–≤–∞–ª—ñ–¥–∞—Ü—ñ—è)
- `router.py` - FastAPI –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏
- `service.py` - –ë—ñ–∑–Ω–µ—Å –ª–æ–≥—ñ–∫–∞
- `dependencies.py` - FastAPI dependencies (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

**–ö–ª—é—á–æ–≤—ñ –º–æ–¥—É–ª—ñ:**
- `core/` - Database, auth, email, cache, scheduler, translations
- `users/` - –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è (Telegram + Email)
- `wallet/` - OMR Coins, Gumroad webhook
- `subscriptions/` - Premium –ø—ñ–¥–ø–∏—Å–∫–∏
- `bonuses/` - –©–æ–¥–µ–Ω–Ω—ñ –±–æ–Ω—É—Å–∏, referral rewards
- `admin/` - –ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å (CRUD products, users, stats)

### Frontend - Next.js App Router

**State Management:**
- `authStore` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è (JWT, user data)
- `cartStore` - –ö–æ—à–∏–∫ –ø–æ–∫—É–ø–æ–∫
- `languageStore` - –ú–æ–≤–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
- `uiStore` - UI —Å—Ç–∞–Ω (modals, theme)

**API Layer:**
- –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π axios client –≤ `lib/api.ts`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ —ñ–Ω–∂–µ–∫—Ü—ñ—è JWT —Ç–æ–∫–µ–Ω—É —Ç–∞ `Accept-Language`
- –ü–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è 401 –ø–æ–º–∏–ª–æ–∫ (auto logout)

**–¢–µ–º–∏:**
- –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –∑ Telegram —Ç–∞ OS theme
- Light/Dark mode —á–µ—Ä–µ–∑ `useTheme()` hook
- –ö–æ–ª—ñ—Ä–Ω–∞ –ø–∞–ª—ñ—Ç—Ä–∞ –≤ `lib/theme.ts`

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è

**Telegram Flow:**
1. Frontend –æ—Ç—Ä–∏–º—É—î `window.Telegram.WebApp.initData`
2. POST `/api/v1/auth/telegram` –∑ initData
3. Backend –≤–∞–ª—ñ–¥—É—î HMAC-SHA256 –ø—ñ–¥–ø–∏—Å
4. –ü–æ–≤–µ—Ä—Ç–∞—î JWT token
5. Frontend –∑–±–µ—Ä—ñ–≥–∞—î –≤ Zustand + localStorage

**Email Flow:**
1. –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è: POST `/api/v1/auth/register`
2. Email verification: GET `/api/v1/auth/verify-email?token=...`
3. Login: POST `/api/v1/auth/login-email`
4. –ü–æ–≤–µ—Ä—Ç–∞—î JWT token

**Account Merging:**
- Telegram –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –¥–æ–¥–∞—Ç–∏ email
- Email –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏ Telegram
- –ü—Ä–∏ merge: –±–∞–ª–ª–∞–Ω—Å —Å—É–º—É—î—Ç—å—Å—è, streak –∑–∞–ª–∏—à–∞—î –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π

### –ü–ª–∞—Ç–µ–∂—ñ

**OMR Coins —Å–∏—Å—Ç–µ–º–∞:**
- –ö–æ–Ω–≤–µ—Ä—Å—ñ—è: 100 coins = $1 USD
- Coin packs –ø—Ä–æ–¥–∞—é—Ç—å—Å—è —á–µ—Ä–µ–∑ Gumroad
- Webhook: `POST /api/v1/webhooks/gumroad`
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è signature —á–µ—Ä–µ–∑ `GUMROAD_WEBHOOK_SECRET`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–∞—Ä–∞—Ö—É–≤–∞–Ω–Ω—è –Ω–∞ –±–∞–ª–∞–Ω—Å

**Gumroad Integration:**
1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∫–ª—ñ–∫–∞—î "Buy Pack"
2. –ü–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ Gumroad –∑ `custom_fields[user_id]`
3. –ü—ñ—Å–ª—è –æ–ø–ª–∞—Ç–∏ Gumroad –Ω–∞–¥—Å–∏–ª–∞—î webhook
4. Backend —Å—Ç–≤–æ—Ä—é—î `Transaction`, –æ–Ω–æ–≤–ª—é—î –±–∞–ª–∞–Ω—Å
5. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–∞—á–∏—Ç—å –æ–Ω–æ–≤–ª–µ–Ω–∏–π –±–∞–ª–∞–Ω—Å

**–ü–æ–∫—É–ø–∫–∞ –ø—Ä–æ–¥—É–∫—Ç—ñ–≤:**
- –°–ø–∏—Å–∞–Ω–Ω—è OMR Coins –∑ –±–∞–ª–∞–Ω—Å—É
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è `Order` —Ç–∞ `OrderItem`
- –ù–∞–¥–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É —á–µ—Ä–µ–∑ `UserProductAccess`
- Email –∑ download links

### –ü—ñ–¥–ø–∏—Å–∫–∞

- –¶—ñ–Ω–∞: 500 OMR coins ($5 USD)
- –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: 30 –¥–Ω—ñ–≤
- –î–æ—Å—Ç—É–ø –¥–æ –≤—Å—ñ—Ö `product_type='premium'` —Ç–æ–≤–∞—Ä—ñ–≤
- Auto-renewal: –∫–µ—Ä—É—î—Ç—å—Å—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º
- Expiration warnings —á–µ—Ä–µ–∑ Telegram bot

### –ë–æ–Ω—É—Å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞

**–©–æ–¥–µ–Ω–Ω—ñ –±–æ–Ω—É—Å–∏:**
- –î–µ–Ω—å 1: 10 coins
- –î–µ–Ω—å 2: 20 coins
- –î–µ–Ω—å 3: 30 coins
- –î–µ–Ω—å 4: 40 coins
- –î–µ–Ω—å 5+: 50 coins
- Streak —Å–∫–∏–¥–∞—î—Ç—å—Å—è —è–∫—â–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –¥–µ–Ω—å

**–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞:**
- –ö–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π `referral_code`
- Deep link: `t.me/your_bot?start=ref_CODE`
- 5% –≤—ñ–¥ –≤—Å—ñ—Ö –ø–æ–∫—É–ø–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª—ñ–≤ (–¥–µ–ø–æ–∑–∏—Ç–∏, –ø—Ä–æ–¥—É–∫—Ç–∏)
- –í–∏–ø–ª–∞—Ç–∞ —É OMR Coins

### Email —Å–∏—Å—Ç–µ–º–∞

**Resend (primary):**
- –û—Å–Ω–æ–≤–Ω–∏–π email —Å–µ—Ä–≤—ñ—Å
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `RESEND_API_KEY`
- Domain verification –ø–æ—Ç—Ä—ñ–±–µ–Ω –¥–ª—è production

**Gmail Fallback:**
- –ó–∞–ø–∞—Å–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç —è–∫—â–æ Resend –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π
- –ù–∞–ª–∞—à—Ç–æ–≤—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `GMAIL_USER` —Ç–∞ `GMAIL_APP_PASSWORD`

**Email types:**
- Verification emails (–Ω–æ–≤—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ, merge)
- Order confirmations (–∑ download links)
- Subscription notifications
- Password reset

### –§–æ–Ω–æ–≤—ñ –∑–∞–¥–∞—á—ñ (Scheduler)

**Daily cleanup (00:00 UTC):**
- –í–∏–¥–∞–ª–µ–Ω–Ω—è –Ω–µ–ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏—Ö email –∞–∫–∞—É–Ω—Ç—ñ–≤ (>7 –¥–Ω—ñ–≤)
- –ù–µ —Ç–æ—Ä–∫–∞—î—Ç—å—Å—è Telegram-only –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- Double-check –Ω–∞ `is_email_verified`

**Subscription check (—â–æ–≥–æ–¥–∏–Ω–∏):**
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è –ø—ñ–¥–ø–∏—Å–æ–∫
- Telegram –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–∞ 3 –¥–Ω—ñ, 1 –¥–µ–Ω—å –¥–æ –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è

## üîê –ë–µ–∑–ø–µ–∫–∞

### Best Practices

1. **Environment Variables** - –í—Å—ñ —Å–µ–∫—Ä–µ—Ç–∏ –≤ `.env`, –Ω–µ –≤ –∫–æ–¥—ñ
2. **JWT Authentication** - –ü—ñ–¥–ø–∏—Å–∞–Ω—ñ —Ç–æ–∫–µ–Ω–∏, –µ–∫—Å–ø—ñ—Ä–∞—Ü—ñ—è 48 –≥–æ–¥–∏–Ω
3. **Telegram InitData Validation** - HMAC-SHA256 –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞
4. **CORS** - –ù–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ origins
5. **Rate Limiting** - Redis-based (100 req/60s –Ω–∞ API routes)
6. **SQL Injection Protection** - SQLAlchemy ORM
7. **XSS Protection** - React –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π escaping
8. **Password Hashing** - bcrypt –∑ —Å–æ–ª—è–º–∏
9. **Email Verification** - –û–±–æ–≤'—è–∑–∫–æ–≤–µ –¥–ª—è –ø–æ–∫—É–ø–æ–∫
10. **Webhook Signatures** - Gumroad signature validation

### Security Headers

```python
# CORS
ALLOWED_ORIGINS = ["http://localhost:3000", "https://t.me", "https://web.telegram.org"]

# JWT
SECRET_KEY = "min-32-chars-random-string"
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_HOURS = 48
```

## üåç –Ü–Ω—Ç–µ—Ä–Ω–∞—Ü—ñ–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è

### –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –º–æ–≤–∏

- üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ (–æ—Å–Ω–æ–≤–Ω–∞)
- üá¨üáß English
- üá∑üá∫ –†—É—Å—Å–∫–∏–π
- üá©üá™ Deutsch
- üá™üá∏ Espa√±ol

### –ü–µ—Ä–µ–∫–ª–∞–¥–∏

**Backend:**
- –•–∞—Ä–¥–∫–æ–¥–µ–Ω—ñ –≤ `backend/app/core/translations.py`
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: `get_text("key", "uk", param1=value)`
- Header: `Accept-Language: uk`

**Frontend:**
- JSON —Ñ–∞–π–ª–∏ –≤ `frontend/public/locales/{lang}.json`
- i18next + react-i18next
- Auto-detection –∑ Telegram —Ç–∞ browser language

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –ø–µ—Ä–µ–∫–ª–∞–¥–∏:**
- DeepL API –¥–ª—è –ø–µ—Ä–µ–∫–ª–∞–¥—É product content
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è `title_en`, `description_ru`, —ñ —Ç.–¥.

## üìä –ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å

**–î–æ—Å—Ç—É–ø:** `/admin` (–ø–æ—Ç—Ä—ñ–±–µ–Ω `is_admin=true` –≤ –ë–î)

**–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª:**
- üì¶ Products CRUD - —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è, —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è, –≤–∏–¥–∞–ª–µ–Ω–Ω—è
- üë• Users management - –ø–µ—Ä–µ–≥–ª—è–¥, —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –±–∞–ª–∞–Ω—Å—É, admin –ø—Ä–∞–≤–∞
- üìà Statistics - –≥—Ä–∞—Ñ—ñ–∫–∏ –ø—Ä–æ–¥–∞–∂—ñ–≤, –ø—ñ–¥–ø–∏—Å–æ–∫, –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- üéüÔ∏è Promo codes - —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
- üì§ File uploads - –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å —Ç–∞ –∞—Ä—Ö—ñ–≤—ñ–≤
- üîç Search —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ –≤—Å—ñ—Ö —Å—É—Ç–Ω–æ—Å—Ç—è—Ö

## üêõ Troubleshooting

### Telegram Webhook –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** Backend –ª–æ–≥–∏ –ø–æ–∫–∞–∑—É—é—Ç—å –ø–æ–º–∏–ª–∫—É –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è webhook

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ `BACKEND_URL` –ø—É–±–ª—ñ—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–∏–π
2. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ ngrok/Cloudflare Tunnel –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ—ó —Ä–æ–∑—Ä–æ–±–∫–∏
3. Webhook URL: `{BACKEND_URL}/api/v1/webhook/{BOT_TOKEN}`

### 401 Unauthorized –≤ API

**–ú–æ–∂–ª–∏–≤—ñ –ø—Ä–∏—á–∏–Ω–∏:**
- JWT —Ç–æ–∫–µ–Ω –∑–∞–∫—ñ–Ω—á–∏–≤—Å—è (>48 –≥–æ–¥–∏–Ω)
- –¢–æ–∫–µ–Ω –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω–æ –≤ header `Authorization: Bearer <token>`
- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –¥–µ–∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∏–π (`is_active=false`)

**–†—ñ—à–µ–Ω–Ω—è:**
- –ü–µ—Ä–µ–ª–æ–≥—ñ–Ω–∏—Ç–∏—Å—å (frontend auto-logout –ø—Ä–∏ 401)
- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ —Ç–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –≤ axios interceptor

### CORS –ø–æ–º–∏–ª–∫–∏

**–†—ñ—à–µ–Ω–Ω—è:**
```bash
# –í .env –¥–æ–¥–∞–π—Ç–µ origin
ALLOWED_ORIGINS=http://localhost:3000,https://yourdomain.com
```

### –§–∞–π–ª–∏ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è

**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ:**
1. `MAX_UPLOAD_SIZE_MB` –≤ `.env` (default: 500MB)
2. –ü—Ä–∞–≤–∞ –Ω–∞ `/app/uploads` –≤ backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ
3. Volume mount: `backend_uploads:/app/uploads`

### –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö migration conflicts

```bash
# Rollback
make downgrade

# –í–∏–¥–∞–ª–∏—Ç–∏ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç–Ω—ñ —Ñ–∞–π–ª–∏ –º—ñ–≥—Ä–∞—Ü—ñ–π
rm backend/alembic/versions/conflicting_*.py

# –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É
make makemigration msg="fix conflicts"

# –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏
make migrate
```

## üöÄ Production Deployment

### –ß–µ–∫–ª–∏—Å—Ç

- [ ] `ENVIRONMENT=production` –≤ `.env`
- [ ] `DEBUG=False`
- [ ] –°–∏–ª—å–Ω–∏–π `SECRET_KEY` (32+ chars)
- [ ] –í–∞–ª—ñ–¥–Ω–∏–π `SENTRY_DSN` –¥–ª—è error tracking
- [ ] `ALLOWED_ORIGINS` –±–µ–∑ wildcards
- [ ] HTTPS –¥–ª—è `FRONTEND_URL` —Ç–∞ `BACKEND_URL`
- [ ] –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ Cloudflare Tunnel –∞–±–æ reverse proxy
- [ ] DNS –∑–∞–ø–∏—Å–∏ (SPF, DKIM, DMARC) –¥–ª—è email –¥–æ–º–µ–Ω—É
- [ ] Resend domain verification
- [ ] Database backups (cron + `make db-backup`)
- [ ] Gunicorn –∑–∞–º—ñ—Å—Ç—å uvicorn (production ASGI server)
- [ ] Rate limiting –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –ø—ñ–¥ —Ä–µ–∞–ª—å–Ω–∏–π —Ç—Ä–∞—Ñ—ñ–∫
- [ ] Monitoring (Sentry, logs aggregation)

### Docker Production

```bash
# –£ docker-compose.yml –∑–º—ñ–Ω—ñ—Ç—å:
command: gunicorn app.main:app -w 4 -k uvicorn.workers.UvicornWorker -b 0.0.0.0:8000

# –ó–∞–ø—É—Å—Ç—ñ—Ç—å
docker-compose -f docker-compose.prod.yml up -d
```

### Nginx config

```nginx
server {
    listen 80;
    server_name yourdomain.com;

    location /api {
        proxy_pass http://backend:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    location / {
        proxy_pass http://frontend:3000;
        proxy_set_header Host $host;
    }
}
```

## üìù Changelog

### v1.7.3 (Current)
- ‚úâÔ∏è –û–Ω–æ–≤–ª–µ–Ω–æ email –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –Ω–∞ support@ohmyrevit.pp.ua
- üé® –£–Ω—ñ—Ñ—ñ–∫–∞—Ü—ñ—è –¥–∏–∑–∞–π–Ω —Å–∏—Å—Ç–µ–º–∏ –∑ useTheme()

### v1.7.2
- üé® –ü–æ–≤–Ω–∞ —É–Ω—ñ—Ñ—ñ–∫–∞—Ü—ñ—è frontend —Ç–µ–º–∏

### v1.7.1
- ‚úâÔ∏è –î–æ–¥–∞–Ω–æ Resend email —Å–µ—Ä–≤—ñ—Å –∑ Gmail fallback

### v1.6.8
- üìú –î–æ–¥–∞–Ω–æ Privacy Policy —Å—Ç–æ—Ä—ñ–Ω–∫—É
- üåç –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞ –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—è privacy policy

### v1.6.7
- üîê –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–∏–π –±–∞–≥ –∑ account merge (email verification bypass)
- ‚úÖ –î–æ–¥–∞–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É email –ø–µ—Ä–µ–¥ –æ–ø–ª–∞—Ç–æ—é (EmailRequiredModal)
- üîÑ –ü–æ–∫—Ä–∞—â–µ–Ω–æ –±–µ–∑–ø–µ–∫—É cleanup scheduler

## ü§ù Contributing

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
2. –°—Ç–≤–æ—Ä—ñ—Ç—å feature branch: `git checkout -b feature/amazing-feature`
3. Commit –∑–º—ñ–Ω–∏: `git commit -m 'Add amazing feature'`
4. Push –≤ branch: `git push origin feature/amazing-feature`
5. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Pull Request

**Coding Standards:**
- Backend: Black formatting, Flake8 linting
- Frontend: ESLint + Prettier
- Commit messages —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –∞–±–æ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é
- Version bumps —É commit message (e.g., "1.7.4 Add Stripe integration")

## üìÑ –õ—ñ—Ü–µ–Ω–∑—ñ—è

Proprietary - –í—Å—ñ –ø—Ä–∞–≤–∞ –∑–∞—Ö–∏—â–µ–Ω—ñ

## üìû –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

- üìß Email: support@ohmyrevit.pp.ua
- üí¨ Telegram: [@your_support_bot](https://t.me/your_support_bot)
- üêõ Issues: [GitHub Issues](https://github.com/yourusername/ohmyrevit/issues)

## üôè –ü–æ–¥—è–∫–∏

- [FastAPI](https://fastapi.tiangolo.com/) - Modern Python web framework
- [Next.js](https://nextjs.org/) - React framework
- [Telegram](https://core.telegram.org/bots/webapps) - Mini Apps platform
- [Gumroad](https://gumroad.com/) - Payment processing
- [Resend](https://resend.com/) - Email delivery
- [DeepL](https://www.deepl.com/) - Translation API

---

Made with ‚ù§Ô∏è for Revit community
